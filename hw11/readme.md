Домашние задания по курсу "Безопасность Linux"
===============================================

ДЗ 11 - CTF
-----------------------------------------------

0. скачал [образ](https://drive.google.com/file/d/1UsidylYDaoWrjUb5J8sLwm3MBoIIfo9e/view) с гуглодиска
1. импортировал в virtualbox
2. зашел в режиме восстановления под рутом, создал пользователя djabber с sudo
3. включил ssh
4. зашел по ssh под пользователем sudo
5. просмотрел логи, в auth.log обнаружил записи о брутфорсе ssh под пользователем test с сервера 192.168.1.38 и успешный вход.
6. в логах также увидел, что в этот момент в системе был также пользователь prod
7. зашел в дамашнюю папку пользователя test - увидел файл message с сообщением о том,  что все файлы зашифрованы, в папке data нашел зашифрованный файл [secrets.txt.enc](secrets.txt.enc)
8. зашел в папку пользователя prod - увидел файл dump.pcap с записью трафика за период, который соответствовал времени атаки
9. wireshark'ом нашел криптор - он видимо был загружен по http и выполнен в браузере
10. выкачал из дампа [криптор](encryptor.py), деобфусцировал руками ([см.тут](encryptor2.py))
11. в коде криптора увидел, что ключ, которым зашифроманы файлы передан на хост 192.168.1.38 на сервер на порту 9999
12. wireshark'ом нашел соединение на порт 9999, выкачал из дампа [ключ](keydata.txt)
13. на основе кода криптора написал [декриптор](decryptor.py)
14. получил расшифрованный файл [secrets.txt](secrets.txt.enc)
15. написал [отчет](отчет.docx)
